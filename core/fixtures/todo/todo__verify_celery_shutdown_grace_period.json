[
  {
    "model": "core.todo",
    "fields": {
      "request": "Manual QA: Confirm Celery worker waits for graceful shutdown",
      "created_on": "2025-11-14T00:00:00Z",
      "url": "",
      "request_details": "1. Deploy the release to a node that runs the celery-arthexis.service unit.\n2. Export CELERY_WORKER_SHUTDOWN_TIMEOUT=60 for the worker environment or confirm the service drop-in inherits the default. Restart the Celery service.\n3. In a new shell, run `python manage.py shell -c \"from core.tasks import check_github_updates; check_github_updates.delay()\"` to queue a long-running task. Wait 5 seconds for the task to start.\n4. Run `sudo systemctl stop celery-arthexis.service` while the task is still running.\n5. Observe the worker logs (`journalctl -u celery-arthexis.service`) and confirm the task finishes before the worker exits, without `Restoring <n> unacknowledged message(s)` warnings.\n6. Start the worker again and confirm the task is not re-queued (the queue remains empty).",
      "done_on": null,
      "is_deleted": false,
      "version": "0.1.33"
    }
  }
]
