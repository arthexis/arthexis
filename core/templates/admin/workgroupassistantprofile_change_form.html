{% extends "admin/django_object_actions_user_datum_change_form.html" %}
{% load i18n %}

{% block object-tools-items %}
    {% if original %}
    <li><a href="../generate-key/" class="addlink">{% trans "Generate Key" %}</a></li>
    {% endif %}
    {{ block.super }}
{% endblock %}

{% block form_top %}
<p class="help">
    Use the Assistant Profiles list to start the MCP server and confirm it is
    running before sharing credentials. Once online, open
    <a href="https://platform.openai.com/docs/gpts/tools/model-context-protocol"
       target="_blank" rel="noopener">ChatGPT Developer Mode</a>
    and register a Model Context Protocol server pointing to
    <code>{{ mcp_server_base_url|default:"http://127.0.0.1:8800" }}</code>.
    Requests must call <code>/api/chat/</code> and include the API key in the
    <code>Authorization</code> header as <code>Bearer &lt;key&gt;</code>.
</p>
<p class="help">
    ChatGPT fetches OAuth metadata from
    <code>{{ mcp_server_issuer_url|default:"http://127.0.0.1:8800" }}</code>. If the
    connector shows <strong>Error fetching OAuth configuration</strong>, verify
    this URL is reachable over HTTPS. Update the
    <a href="https://docs.djangoproject.com/en/stable/ref/contrib/sites/"
       target="_blank" rel="noopener">Site domain</a>,
    or set <code>MCP_SIGIL_RESOURCE_URL</code> and
    <code>MCP_SIGIL_ISSUER_URL</code> to override the advertised URLs.
</p>
{% endblock %}
