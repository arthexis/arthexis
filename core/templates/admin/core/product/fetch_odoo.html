{% extends "admin/base_site.html" %}
{% load i18n admin_urls %}

{% block extrahead %}{{ block.super }}{{ media }}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
  <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a> ›
  <a href="{% url 'admin:app_list' opts.app_label %}">{{ opts.app_config.verbose_name }}</a> ›
  <a href="{% url opts|admin_urlname:'changelist' %}">{{ opts.verbose_name_plural|capfirst }}</a> ›
  {% trans 'Fetch Odoo Product' %}
</div>
{% endblock %}

{% block content %}
<h1>{% trans 'Fetch Odoo Product' %}</h1>
{% if credential_error %}
  <div class="messagelist">
    <div class="error">{{ credential_error }}
      {% if profile_url %}
        <a href="{{ profile_url }}">{% trans 'Manage Odoo credentials' %}</a>
      {% endif %}
    </div>
  </div>
{% endif %}

{% if has_credentials %}
<form method="post" action="">
  {% csrf_token %}
  <fieldset class="module aligned">
    {% for field in form.visible_fields %}
      <div class="form-row">
        {{ field.errors }}
        {{ field.label_tag }} {{ field }}
        {% if field.help_text %}<p class="help">{{ field.help_text }}</p>{% endif %}
      </div>
    {% endfor %}
    {{ form.non_field_errors }}
    {% for obj in queryset %}
      <input type="hidden" name="_selected_action" value="{{ obj.pk }}">
    {% endfor %}
    <input type="hidden" name="action" value="{{ action }}">
    <input type="hidden" name="apply" value="yes">
  </fieldset>
  {% if results is not None %}
    <h2>{% trans 'Search results' %}</h2>
    <table class="adminlist">
      <thead>
        <tr>
          <th>{% trans 'Select' %}</th>
          <th>{% trans 'Name' %}</th>
          <th>{% trans 'Internal reference' %}</th>
          <th>{% trans 'Barcode' %}</th>
          <th>{% trans 'Description' %}</th>
        </tr>
      </thead>
      <tbody>
        {% for product in results %}
          <tr>
            <td>
              <input type="radio" name="product_id" value="{{ product.id }}"{% if product.id|stringformat:'s' == selected_product_id %} checked{% endif %}>
            </td>
            <td>{{ product.name }}</td>
            <td>{{ product.default_code }}</td>
            <td>{{ product.barcode }}</td>
            <td>{{ product.description_sale }}</td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="5">{% trans 'No products found.' %}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}
  <div class="submit-row">
    <button type="submit" name="search" value="yes" class="button">{% trans 'Search' %}</button>
    {% if results %}
      <button type="submit" name="import" value="yes" class="button default">{% trans 'Import selected product' %}</button>
    {% endif %}
  </div>
</form>
{% endif %}
{% endblock %}
