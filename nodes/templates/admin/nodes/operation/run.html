{% extends "admin/base_site.html" %}
{% load i18n %}

{% block content %}
<h1>{{ operation.name }}</h1>
<div class="interrupts">
  {% for interrupt, preview in interrupts %}
    <a class="button" href="?interrupt={{ interrupt.pk }}" title="{{ preview }}">{{ interrupt.name }}</a>
  {% endfor %}
</div>
<div class="operation-template">
  {{ template|linebreaks }}
</div>
{% if waiting_inputs %}
  <form method="post">
    {% csrf_token %}
    <table>
      {% for token, name in waiting_inputs %}
        <tr><th>{{ token }}</th><td><input type="text" name="{{ name }}"></td></tr>
      {% endfor %}
    </table>
    <input type="submit" value="{% trans 'Submit' %}">
  </form>
{% elif waiting_continue %}
  <form method="post">
    {% csrf_token %}
    <input type="submit" value="{% trans 'Continue' %}">
  </form>
{% elif running %}
  <p>{% trans "Effect running..." %}</p>
{% else %}
  <form method="post">
    {% csrf_token %}
    <input type="submit" value="{% trans 'Run next effect' %}">
  </form>
{% endif %}

<div class="logs">
  {% for log in logs %}
    <div class="log-entry">
      <strong>{{ log.effect.command }}</strong>
      {% if log.output %}<pre>{{ log.output }}</pre>{% endif %}
      {% if log.error %}<pre class="error">{{ log.error }}</pre>{% endif %}
    </div>
  {% endfor %}
</div>
{% endblock %}
