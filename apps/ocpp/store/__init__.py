"""In-memory store for OCPP data with file backed logs."""

from __future__ import annotations

from .logs import (
    BASE_DIR,
    LOCK_DIR,
    LOG_DIR,
    MAX_IN_MEMORY_LOG_ENTRIES,
    SESSION_DIR,
    SESSION_LOCK,
    SESSION_LOG_BUFFER_LIMIT,
    LogEntry,
    _append_memory_log,
    _charger_log_basename,
    _file_path,
    _finalize_session,
    _flush_session_buffer,
    _iter_file_lines_reverse,
    _iter_log_entries_for_key,
    _log_file_for_identifier,
    _log_key_candidates,
    _memory_logs_for_identifier,
    _parse_log_timestamp,
    _resolve_log_identifier,
    _safe_name,
    _session_folder,
    _write_log_file,
    add_log,
    add_session_message,
    append_log_capture,
    clear_log,
    end_session_log,
    finalize_log_capture,
    get_logs,
    history,
    iter_file_lines_reverse,
    iter_log_entries,
    log_names,
    logs,
    register_log_name,
    resolve_log_path,
    start_log_capture,
    start_session_lock,
    start_session_log,
    stop_session_lock,
)
from .pending_calls import (
    _clear_pending_redis,
    _load_pending_metadata_redis,
    _load_pending_result_redis,
    _pending_call_events,
    _pending_call_handles,
    _pending_call_lock,
    _pending_call_results,
    _pending_metadata_key,
    _pending_result_key,
    _store_pending_metadata_redis,
    _store_pending_result_redis,
    _monitoring_report_lock,
    clear_pending_calls,
    consume_triggered_followup,
    get_monitoring_report_request,
    monitoring_report_requests,
    pending_calls,
    pop_monitoring_report_request,
    pop_pending_call,
    record_pending_call_result,
    register_monitoring_report_request,
    register_pending_call,
    register_triggered_followup,
    restore_pending_calls,
    schedule_call_timeout,
    triggered_followups,
    wait_for_pending_call,
)
from .redis_state import (
    _IP_CONNECTION_TTL,
    _PENDING_TTL,
    _STATE_REDIS,
    _STATE_REDIS_URL,
    _connection_token,
    _redis_ip_key,
    _register_ip_connection_redis,
    _release_ip_connection_redis,
    _state_redis,
    register_ip_connection,
    release_ip_connection,
)
from .scheduler import (
    _cancel_timer_handle,
    _ensure_scheduler_loop,
    _run_scheduler_loop,
    _scheduler_lock,
    _scheduler_loop,
    _scheduler_thread,
)
from .state import (
    AGGREGATE_SLUG,
    IDENTITY_SEPARATOR,
    MAX_CONNECTIONS_PER_IP,
    PENDING_SLUG,
    _candidate_keys,
    connections,
    connector_slug,
    get_connection,
    get_transaction,
    identity_key,
    ip_connections,
    is_connected,
    iter_identity_keys,
    pending_key,
    pop_connection,
    pop_transaction,
    reassign_identity,
    set_connection,
    set_transaction,
    simulators,
    transactions,
)
from .transactions import (
    _add_transaction_index_entry,
    _normalize_transaction_id,
    _remove_transaction_index_entry,
    _transaction_connector_key,
    _transaction_requests_by_connector,
    _transaction_requests_by_transaction,
    _transaction_requests_lock,
    billing_updates,
    charging_profile_reports,
    clear_display_message_compliance,
    connector_release_notifications,
    display_message_compliance,
    ev_charging_needs,
    ev_charging_schedules,
    find_transaction_requests,
    forward_connector_release,
    forward_cost_update_to_billing,
    forward_ev_charging_schedule,
    forward_event_to_observability,
    mark_transaction_requests,
    monitoring_reports,
    observability_events,
    planner_notifications,
    record_display_message_compliance,
    record_ev_charging_needs,
    record_ev_charging_schedule,
    record_monitoring_report,
    record_reported_charging_profile,
    record_transaction_event,
    register_transaction_request,
    transaction_events,
    transaction_requests,
    update_transaction_request,
    consume_reported_charging_profiles,
)

__all__ = [
    "IDENTITY_SEPARATOR",
    "AGGREGATE_SLUG",
    "PENDING_SLUG",
    "MAX_CONNECTIONS_PER_IP",
    "MAX_IN_MEMORY_LOG_ENTRIES",
    "SESSION_LOG_BUFFER_LIMIT",
    "_STATE_REDIS",
    "_STATE_REDIS_URL",
    "_PENDING_TTL",
    "_IP_CONNECTION_TTL",
    "_scheduler_loop",
    "_scheduler_thread",
    "_scheduler_lock",
    "_pending_call_events",
    "_pending_call_results",
    "_pending_call_lock",
    "_pending_call_handles",
    "_monitoring_report_lock",
    "_transaction_requests_by_connector",
    "_transaction_requests_by_transaction",
    "_transaction_requests_lock",
    "connections",
    "transactions",
    "history",
    "simulators",
    "ip_connections",
    "logs",
    "log_names",
    "pending_calls",
    "triggered_followups",
    "monitoring_report_requests",
    "transaction_requests",
    "billing_updates",
    "ev_charging_needs",
    "ev_charging_schedules",
    "planner_notifications",
    "observability_events",
    "transaction_events",
    "connector_release_notifications",
    "monitoring_reports",
    "display_message_compliance",
    "charging_profile_reports",
    "BASE_DIR",
    "LOG_DIR",
    "SESSION_DIR",
    "LOCK_DIR",
    "SESSION_LOCK",
    "LogEntry",
    "connector_slug",
    "identity_key",
    "pending_key",
    "_candidate_keys",
    "iter_identity_keys",
    "is_connected",
    "get_connection",
    "set_connection",
    "pop_connection",
    "get_transaction",
    "set_transaction",
    "pop_transaction",
    "reassign_identity",
    "_state_redis",
    "_connection_token",
    "_redis_ip_key",
    "_register_ip_connection_redis",
    "_release_ip_connection_redis",
    "register_ip_connection",
    "release_ip_connection",
    "_pending_metadata_key",
    "_pending_result_key",
    "_store_pending_metadata_redis",
    "_load_pending_metadata_redis",
    "_store_pending_result_redis",
    "_load_pending_result_redis",
    "_clear_pending_redis",
    "register_pending_call",
    "register_monitoring_report_request",
    "get_monitoring_report_request",
    "pop_monitoring_report_request",
    "pop_pending_call",
    "record_pending_call_result",
    "wait_for_pending_call",
    "schedule_call_timeout",
    "register_triggered_followup",
    "consume_triggered_followup",
    "clear_pending_calls",
    "restore_pending_calls",
    "_run_scheduler_loop",
    "_ensure_scheduler_loop",
    "_cancel_timer_handle",
    "register_log_name",
    "add_log",
    "_append_memory_log",
    "_write_log_file",
    "start_log_capture",
    "append_log_capture",
    "finalize_log_capture",
    "_session_folder",
    "start_session_log",
    "add_session_message",
    "end_session_log",
    "_flush_session_buffer",
    "_finalize_session",
    "_safe_name",
    "_charger_log_basename",
    "_file_path",
    "_log_key_candidates",
    "_resolve_log_identifier",
    "_log_file_for_identifier",
    "_memory_logs_for_identifier",
    "_parse_log_timestamp",
    "_iter_file_lines_reverse",
    "iter_file_lines_reverse",
    "_iter_log_entries_for_key",
    "iter_log_entries",
    "get_logs",
    "resolve_log_path",
    "clear_log",
    "start_session_lock",
    "stop_session_lock",
    "register_transaction_request",
    "record_display_message_compliance",
    "clear_display_message_compliance",
    "record_reported_charging_profile",
    "consume_reported_charging_profiles",
    "record_ev_charging_needs",
    "record_ev_charging_schedule",
    "record_monitoring_report",
    "forward_ev_charging_schedule",
    "forward_event_to_observability",
    "record_transaction_event",
    "forward_connector_release",
    "update_transaction_request",
    "find_transaction_requests",
    "mark_transaction_requests",
    "forward_cost_update_to_billing",
]
